= Solr Start Script Reference
:page-shortname: solr-start-script-reference
:page-permalink: solr-start-script-reference.html

Solr includes a script known as "`bin/solr`" that allows you to start and stop Solr, create and delete collections or cores, and check the status of Solr and configured shards. You can find the script in the `bin/` directory of your Solr installation. The `bin/solr` script makes Solr easier to work with by providing simple commands and options to quickly accomplish common goals.

In this section, the headings below correspond to available commands. For each command, the available options are described with examples.

More examples of bin/solr in use are available throughout the Solr Reference Guide, but particularly in the sections <<running-solr.adoc#running-solr,Running Solr>> and <<getting-started-with-solrcloud.adoc#getting-started-with-solrcloud,Getting Started with SolrCloud>>.

[[SolrStartScriptReference-StartingandStopping]]
== Starting and Stopping

[[SolrStartScriptReference-StartandRestart]]
=== Start and Restart

The start command starts Solr. The restart command allows you to restart Solr while it is already running or if it has been stopped already.

The start and restart commands have several options to allow you to run in SolrCloud mode, use an example configuration set, start with a hostname or port that is not the default and point to a local ZooKeeper ensemble.

`bin/solr start [options]`

`bin/solr start -help`

`bin/solr restart [options]`

`bin/solr restart -help`

When using the restart command, you must pass all of the parameters you initially passed when you started Solr. Behind the scenes, a stop request is initiated, so Solr will be stopped before being started again. If no nodes are already running, restart will skip the step to stop and proceed to starting Solr.

[[SolrStartScriptReference-AvailableParameters]]
==== Available Parameters

The bin/solr script provides many options to allow you to customize the server in common ways, such as changing the listening port. However, most of the defaults are adequate for most Solr installations, especially when just getting started.

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|-a "<string>" |Start Solr with additional JVM parameters, such as those starting with -X. If you are passing JVM parameters that begin with "-D", you can omit the -a option. |`bin/solr start -a "-Xdebug -Xrunjdwp:transport=dt_socket, server=y,suspend=n,address=1044"`
|-cloud a|
Start Solr in SolrCloud mode, which will also launch the embedded ZooKeeper instance included with Solr.

This option can be shortened to simply `-c`.

If you are already running a ZooKeeper ensemble that you want to use instead of the embedded (single-node) ZooKeeper, you should also pass the -z parameter.

For more details, see the section <<SolrStartScriptReference-SolrCloudMode,SolrCloud Mode>> below.

 |`bin/solr start -c`
|-d <dir> |Define a server directory, defaults to `server` (as in, `$SOLR_HOME/server`). It is uncommon to override this option. When running multiple instances of Solr on the same host, it is more common to use the same server directory for each instance and use a unique Solr home directory using the -s option. |`bin/solr start -d newServerDir`
|-e <name> a|
Start Solr with an example configuration. These examples are provided to help you get started faster with Solr generally, or just try a specific feature.

The available options are:

* cloud
* techproducts
* dih
* schemaless

See the section <<SolrStartScriptReference-RunningwithExampleConfigurations,Running with Example Configurations>> below for more details on the example configurations.

 |`bin/solr start -e schemaless`
|-f |Start Solr in the foreground; you cannot use this option when running examples with the -e option. |`bin/solr start -f`
|-h <hostname> |Start Solr with the defined hostname. If this is not specified, 'localhost' will be assumed. |`bin/solr start -h search.mysolr.com`
|-m <memory> |Start Solr with the defined value as the min (-Xms) and max (-Xmx) heap size for the JVM. |`bin/solr start -m 1g`
|-noprompt a|
Start Solr and suppress any prompts that may be seen with another option. This would have the side effect of accepting all defaults implicitly.

For example, when using the "cloud" example, an interactive session guides you through several options for your SolrCloud cluster. If you want to accept all of the defaults, you can simply add the -noprompt option to your request.

 |`bin/solr start -e cloud -noprompt`
|-p <port> |Start Solr on the defined port. If this is not specified, '8983' will be used. |`bin/solr start -p 8655`
|-s <dir> a|
Sets the solr.solr.home system property; Solr will create core directories under this directory. This allows you to run multiple Solr instances on the same host while reusing the same server directory set using the -d parameter. If set, the specified directory should contain a solr.xml file, unless solr.xml exists in ZooKeeper. The default value is `server/solr`.

This parameter is ignored when running examples (-e), as the solr.solr.home depends on which example is run.

 |`bin/solr start -s newHome`
|-V |Start Solr with verbose messages from the start script. |`bin/solr start -V`
|-z <zkHost> |Start Solr with the defined ZooKeeper connection string. This option is only used with the -c option, to start Solr in SolrCloud mode. If this option is not provided, Solr will start the embedded ZooKeeper instance and use that instance for SolrCloud operations. |`bin/solr start -c -z server1:2181,server2:2181`
|===

To emphasize how the default settings work take a moment to understand that the following commands are equivalent:

`bin/solr start`

`bin/solr start -h localhost -p 8983 -d server -s solr -m 512m`

It is not necessary to define all of the options when starting if the defaults are fine for your needs.

[[SolrStartScriptReference-SettingJavaSystemProperties]]
==== Setting Java System Properties

The bin/solr script will pass any additional parameters that begin with -D to the JVM, which allows you to set arbitrary Java system properties. For example, to set the auto soft-commit frequency to 3 seconds, you can do:

`bin/solr start -Dsolr.autoSoftCommit.maxTime=3000`

[[SolrStartScriptReference-SolrCloudMode]]
==== SolrCloud Mode

The -c and -cloud options are equivalent:

`bin/solr start -c`

`bin/solr start -cloud`

If you specify a ZooKeeper connection string, such as `-z 192.168.1.4:2181`, then Solr will connect to ZooKeeper and join the cluster. If you do not specify the -z option when starting Solr in cloud mode, then Solr will launch an embedded ZooKeeper server listening on the Solr port + 1000, i.e., if Solr is running on port 8983, then the embedded ZooKeeper will be listening on port 9983.

IMPORTANT: If your ZooKeeper connection string uses a chroot, such as `localhost:2181/solr`, then you need to bootstrap the /solr znode before launching SolrCloud using the bin/solr script. To do this, you need to use the `zkcli.sh` script shipped with Solr, such as:

`server/scripts/cloud-scripts/zkcli.sh -zkhost localhost:2181/solr -cmd bootstrap -solrhome server/solr`

When starting in SolrCloud mode, the interactive script session will prompt you to choose a configset to use.

For more information about starting Solr in SolrCloud mode, see also the section <<getting-started-with-solrcloud.adoc#getting-started-with-solrcloud,Getting Started with SolrCloud>>.

[[SolrStartScriptReference-RunningwithExampleConfigurations]]
==== Running with Example Configurations

`bin/solr start -e <name>`

The example configurations allow you to get started quickly with a configuration that mirrors what you hope to accomplish with Solr.

Each example launches Solr in with a managed schema, which allows use of the <<schema-api.adoc#schema-api,Schema API>> to make schema edits, but does not allow manual editing of a Schema file If you would prefer to manually modify a `schema.xml` file directly, you can change this default as described in the section <<schema-factory-definition-in-solrconfig.adoc#schema-factory-definition-in-solrconfig,Schema Factory Definition in SolrConfig>>.

Unless otherwise noted in the descriptions below, the examples do not enable <<solrcloud.adoc#solrcloud,SolrCloud>> nor <<schemaless-mode.adoc#schemaless-mode,schemaless mode>>.

The following examples are provided:

* **cloud**: This example starts a 1-4 node SolrCloud cluster on a single machine. When chosen, an interactive session will start to guide you through options to select the initial configset to use, the number of nodes for your example cluster, the ports to use, and name of the collection to be created. When using this example, you can choose from any of the available configsets found in `$SOLR_HOME/server/solr/configsets`.
* **techproducts**: This example starts Solr in standalone mode with a schema designed for the sample documents included in the `$SOLR_HOME/example/exampledocs` directory. The configset used can be found in `$SOLR_HOME/server/solr/configsets/sample_techproducts_configs`.
* **dih**: This example starts Solr in standalone mode with the DataImportHandler (DIH) enabled and several example `dataconfig.xml` files pre-configured for different types of data supported with DIH (such as, database contents, email, RSS feeds, etc.). The configset used is customized for DIH, and is found in `$SOLR_HOME/example/example-DIH/solr/conf`. For more information about DIH, see the section <<uploading-structured-data-store-data-with-the-data-import-handler.adoc#uploading-structured-data-store-data-with-the-data-import-handler,Uploading Structured Data Store Data with the Data Import Handler>>.
* **schemaless**: This example starts Solr in standalone mode using a managed schema, as described in the section <<schema-factory-definition-in-solrconfig.adoc#schema-factory-definition-in-solrconfig,Schema Factory Definition in SolrConfig>>, and provides a very minimal pre-defined schema. Solr will run in <<schemaless-mode.adoc#schemaless-mode,Schemaless Mode>> with this configuration, where Solr will create fields in the schema on the fly and will guess field types used in incoming documents. The configset used can be found in `$SOLR_HOME/server/solr/configsets/data_driven_schema_configs`.

[IMPORTANT]
====

The run in-foreground option (-f) does not work with the -e option since the script needs to perform additional tasks after starting the Solr server.

====

[[SolrStartScriptReference-Stop]]
=== Stop

The stop command sends a STOP request to a running Solr node, which allows it to shutdown gracefully. The command will wait up to 5 seconds for Solr to stop gracefully and then will forcefully kill the process (kill -9).

`bin/solr stop [options]`

`bin/solr stop -help`

[[SolrStartScriptReference-AvailableParameters.1]]
==== Available Parameters

[cols=",,",options="header",]
|===
|Parameter |Description |Example
|-p <port> |Stop Solr running on the given port. If you are running more than one instance, or are running in SolrCloud mode, you either need to specify the ports in separate requests or use the -all option. |`bin/solr stop -p 8983`
|-all |Stop all running Solr instances that have a valid PID. |`bin/solr stop -all`
|-k <key> |Stop key used to protect from stopping Solr inadvertently; default is "solrrocks". |`bin/solr stop -k solrrocks`
|===

[[SolrStartScriptReference-Informational]]
== Informational

[[SolrStartScriptReference-Version]]
=== Version

The version command simply returns the version of Solr currently installed and immediately exists.

[source,plain]
----
$ bin/solr version
X.Y.0
----

[[SolrStartScriptReference-Status]]
=== Status

The status command displays basic JSON-formatted information for any Solr nodes found running on the local system. The status command uses the SOLR_PID_DIR environment variable to locate Solr process ID files to find running Solr instances; the SOLR_PID_DIR variable defaults to the bin directory.

`bin/solr status`

The output will include a status of each node of the cluster, as in this example:

[source,plain]
----
Found 2 Solr nodes: 

Solr process 39920 running on port 7574
{
  "solr_home":"/Applications/Solr/example/cloud/node2/solr/",
  "version":"X.Y.0",
  "startTime":"2015-02-10T17:19:54.739Z",
  "uptime":"1 days, 23 hours, 55 minutes, 48 seconds",
  "memory":"77.2 MB (%15.7) of 490.7 MB",
  "cloud":{
    "ZooKeeper":"localhost:9865",
    "liveNodes":"2",
    "collections":"2"}}

Solr process 39827 running on port 8865
{
  "solr_home":"/Applications/Solr/example/cloud/node1/solr/",
  "version":"X.Y.0",
  "startTime":"2015-02-10T17:19:49.057Z",
  "uptime":"1 days, 23 hours, 55 minutes, 54 seconds",
  "memory":"94.2 MB (%19.2) of 490.7 MB",
  "cloud":{
    "ZooKeeper":"localhost:9865",
    "liveNodes":"2",
    "collections":"2"}}
----

[[SolrStartScriptReference-Healthcheck]]
=== Healthcheck

The healthcheck command generates a JSON-formatted health report for a collection when running in SolrCloud mode. The health report provides information about the state of every replica for all shards in a collection, including the number of committed documents and its current state.

`bin/solr healthcheck [options]`

`bin/solr healthcheck -help`

[[SolrStartScriptReference-AvailableParameters.2]]
==== Available Parameters

[cols=",,",options="header",]
|===
|Parameter |Description |Example
|-c <collection> |Name of the collection to run a healthcheck against (required). |`bin/solr healthcheck -c gettingstarted`
|-z <zkhost> |ZooKeeper connection string, defaults to localhost:9983. If you are running Solr on a port other than 8983, you will have to specify the ZooKeeper connection string. By default, this will be the Solr port + 1000. |`bin/solr healthcheck -z localhost:2181`
|===

Below is an example healthcheck request and response using a non-standard ZooKeeper connect string, with 2 nodes running:

[source,plain]
----
$ bin/solr healthcheck -c gettingstarted -z localhost:9865

{
  "collection":"gettingstarted",
  "status":"healthy",
  "numDocs":0,
  "numShards":2,
  "shards":[
    {
      "shard":"shard1",
      "status":"healthy",
      "replicas":[
        {
          "name":"core_node1",
          "url":"http://10.0.1.10:8865/solr/gettingstarted_shard1_replica2/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 48 seconds",
          "memory":"25.6 MB (%5.2) of 490.7 MB",
          "leader":true},
        {
          "name":"core_node4",
          "url":"http://10.0.1.10:7574/solr/gettingstarted_shard1_replica1/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 42 seconds",
          "memory":"95.3 MB (%19.4) of 490.7 MB"}]},
    {
      "shard":"shard2",
      "status":"healthy",
      "replicas":[
        {
          "name":"core_node2",
          "url":"http://10.0.1.10:8865/solr/gettingstarted_shard2_replica2/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 48 seconds",
          "memory":"25.8 MB (%5.3) of 490.7 MB"},
        {
          "name":"core_node3",
          "url":"http://10.0.1.10:7574/solr/gettingstarted_shard2_replica1/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 42 seconds",
          "memory":"95.4 MB (%19.4) of 490.7 MB",
          "leader":true}]}]}
----

[[SolrStartScriptReference-CollectionsandCores]]
== Collections and Cores

The bin/solr script can also help you create new collections (in SolrCloud mode) or cores (in standalone mode), or delete collections.

[[SolrStartScriptReference-Create]]
=== Create

.User permissions on "create"
[WARNING]
====

When using the "create" command, be sure that you run this command as the same user that you use to start Solr. If you use the UNIX/Linux install script, this will normally be a user named "solr". If Solr is running as the solr user but you use root to create a core, then Solr will not be able to write to the directories created by the start script.

If you are running in cloud mode, this very likely will not be a problem. In cloud mode, all the configuration is stored in ZooKeeper, and the create script does not need to make directories or copy configuration files. Solr itself will create all the necessary directories.

====

The create command detects the mode that Solr is running in (standalone or SolrCloud) and then creates a core or collection depending on the mode.

`bin/solr create options`

`bin/solr create -help`

[[SolrStartScriptReference-AvailableParameters.3]]
==== Available Parameters

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|-c <name> |Name of the core or collection to create (required). |`bin/solr create -c mycollection`
|-d <confdir> a|
The configuration directory. This defaults to `data_driven_schema_configs`.

See the section <<SolrStartScriptReference-ConfigurationDirectoriesandSolrCloud,Configuration Directories and SolrCloud>> below for more details about this option when running in SolrCloud mode.

 |`bin/solr create -d basic_configs`
|-n <configName> |The configuration name. This defaults to the same name as the core or collection. |`bin/solr create -n basic`
|-p <port> a|
Port of a local Solr instance to send the create command to; by default the script tries to detect the port by looking for running Solr instances.

This option is useful if you are running multiple standalone Solr instances on the same host, thus requiring you to be specific about which instance to create the core in.

 |`bin/solr create -p 8983`
a|
-s <shards>

-shards

 |Number of shards to split a collection into, default is 1; only applies when Solr is running in SolrCloud mode. |`bin/solr create -s 2`
a|
-rf <replicas>

-replicationFactor

 |Number of copies of each document in the collection. The default is 1 (no replication). |`bin/solr create -rf 2`
|===

[[SolrStartScriptReference-ConfigurationDirectoriesandSolrCloud]]
==== Configuration Directories and SolrCloud

Before creating a collection in SolrCloud, the configuration directory used by the collection must be uploaded to ZooKeeper. The create command supports several use cases for how collections and configuration directories work. The main decision you need to make is whether a configuration directory in ZooKeeper should be shared across multiple collections. Let's work through a few examples to illustrate how configuration directories work in SolrCloud.

First, if you don't provide the `-d` or `-n` options, then the default configuration (`$SOLR_HOME/server/solr/configsets/data_driven_schema_configs/conf`) is uploaded to ZooKeeper using the same name as the collection. For example, the following command will result in the *data_driven_schema_configs* configuration being uploaded to `/configs/contacts` in ZooKeeper: `bin/solr create -c contacts`. If you create another collection, by doing `bin/solr create -c contacts2`, then another copy of the `data_driven_schema_configs` directory will be uploaded to ZooKeeper under `/configs/contacts2`. Any changes you make to the configuration for the contacts collection will not affect the contacts2 collection. Put simply, the default behavior creates a unique copy of the configuration directory for each collection you create.

You can override the name given to the configuration directory in ZooKeeper by using the `-n` option. For instance, the command `bin/solr create -c logs -d basic_configs -n basic` will upload the `server/solr/configsets/basic_configs/conf` directory to ZooKeeper as `/configs/basic`.

Notice that we used the `-d` option to specify a different configuration than the default. Solr provides several built-in configurations under `server/solr/configsets`. However you can also provide the path to your own configuration directory using the `-d` option. For instance, the command `bin/solr create -c mycoll -d /tmp/myconfigs`, will upload `/tmp/myconfigs` into ZooKeeper under `/configs/mycoll` . To reiterate, the configuration directory is named after the collection unless you override it using the `-n` option.

Other collections can share the same configuration by specifying the name of the shared configuration using the `-n` option. For instance, the following command will create a new collection that shares the basic configuration created previously: `bin/solr create -c logs2 -n basic`.

[[SolrStartScriptReference-Data-drivenschemaandsharedconfigurations]]
==== Data-driven schema and shared configurations

The data_driven_schema_configs schema can mutate as data is indexed. Consequently, we recommend that you do not share data-driven configurations between collections unless you are certain that all collections should inherit the changes made when indexing data into one of the collections.

[[SolrStartScriptReference-Delete]]
=== Delete

The delete command detects the mode that Solr is running in (standalone or SolrCloud) and then deletes the specified core (standalone) or collection (SolrCloud) as appropriate.

`bin/solr delete [options]`

`bin/solr delete -help`

If running in SolrCloud mode, the delete command checks if the configuration directory used by the collection you are deleting is being used by other collections. If not, then the configuration directory is also deleted from ZooKeeper. For example, if you created a collection by doing `bin/solr create -c contacts`, then the delete command `bin/solr delete -c contacts` will check to see if the `/configs/contacts` configuration directory is being used by any other collections. If not, then the `/configs/contacts` directory is removed from ZooKeeper.

[[SolrStartScriptReference-AvailableParameters.4]]
==== Available Parameters

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|-c <name> |Name of the core / collection to delete (required). |`bin/solr delete -c mycoll`
|-deleteConfig <true|false> a|
Delete the configuration directory from ZooKeeper. The default is true.

If the configuration directory is being used by another collection, then it will not be deleted even if you pass -deleteConfig true.

 |`bin/solr delete -deleteConfig false`
|-p <port> a|
The port of a local Solr instance to send the delete command to. By default the script tries to detect the port by looking for running Solr instances.

This option is useful if you are running multiple standalone Solr instances on the same host, thus requiring you to be specific about which instance to delete the core from.

 |`bin/solr delete -p 8983`
|===

[[SolrStartScriptReference-ZooKeeperOperations]]
== ZooKeeper Operations

The bin/solr script allows certain operations affecting Zookeeper. These operations are for SolrCloud mode only.

`bin/solr zk [options]`

`bin/solr zk -help`

NOTE: Solr should have been started at least once before issuing these commands to initialize Zookeeper with the znodes Solr expects. Once ZooKeeper is initialized, Solr doesn't need to be running on any node to use these commands.

[[SolrStartScriptReference-UploadingaConfigurationSet]]
=== Uploading a Configuration Set

Use this Zookeeper sub-command to upload one of the pre-configured configuration set or a customized configuration set to Zookeeper.

// OLD_CONFLUENCE_ID: SolrStartScriptReference-AvailableParameters(allparametersarerequired)

[[SolrStartScriptReference-AvailableParameters_allparametersarerequired_]]
==== Available Parameters (all parameters are required)

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|upconfig |Upload a configuration set from the local filesystem to Zookeeper (-upconfig for back compat) |`upconfig`
|-n <name> a|
Name of the configuration set in Zookeeper. This command will upload the configuration set to the "configs" Zookeeper node giving it the name specified.

You can see all uploaded configuration sets in the Admin UI via the Cloud screens. Choose Cloud->tree->configs to see them.

If a pre-existing configuration set is specified, it will be overwritten in Zookeeper.

 |`-n myconfig`
|-d <configset dir> a|
The path of the configuration set to upload. It should have a "conf" directory immediately below it that in turn contains solrconfig.xml etc.

If just a name is supplied, $SOLR_HOME/server/solr/configsets will be checked for this name. An absolute path may be supplied instead.

 a|
`-d directory_under_configsets`

`-d /absolute/path/to/configset/source`

|-z <zkHost> |The Zookeeper connection string. Unnecessary if ZK_HOST is defined in solr.in.sh or solr.in.cmd |`-z 123.321.23.43:2181`
|===

An example of this command with these parameters is:

`bin/solr zk upconfig -z 111.222.333.444:2181 -n mynewconfig -d /path/to/configset`

This command does *not* automatically make changes effective! It simply uploads the configuration sets to Zookeeper. You can use the <<collections-api.adoc#collections-api,Collections API>> to issue a RELOAD command for any collections that uses this configuration set.

[[SolrStartScriptReference-DownloadingaConfigurationSet]]
=== Downloading a Configuration Set

Use this Zookeeper sub-command to download a configuration set from Zookeeper to the local filesystem.

// OLD_CONFLUENCE_ID: SolrStartScriptReference-AvailableParameters(allparametersarerequired).1

[[SolrStartScriptReference-AvailableParameters_allparametersarerequired_.1]]
==== Available Parameters (all parameters are required)

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|downconfig |Download a configuration set from Zookeeper to the local filesystem. (-downconfig for back compat) |`downconfig`
|-n <name> |Name of config set in Zookeeper to download. The Admin UI>>Cloud>>tree>>configs node lists all available configuration sets. |`-n myconfig`
|-d <configset dir> a|
The path to write the downloaded configuration set into.

If just a name is supplied, SOLR_HOME/server/solr/configsets will be the parent.

An absolute path may be supplied as well.

In either case, _pre-existing configurations at the destination will be overwritten!_

 |`-d directory_under_configsets` `-d /absolute/path/to/configset/destination`
|-z <zkHost> |The Zookeeper connection string. Unnecessary if ZK_HOST is defined in http://solr.in[solr.in].sh or http://solr.in[solr.in].cmd |`-z 123.321.23.43:2181 `
|===

An example of this command with the parameters is:

`bin/solr zk downconfig -z 111.222.333.444:2181 -n mynewconfig -d /path/to/configset`

A "best practice" is to keep your configuration sets in some form of version control as the system-of-record. In that scenario, `downconfig` should rarely be used.

[[SolrStartScriptReference-CopybetweenlocalfilesandZookeeperznodes]]
=== Copy between local files and Zookeeper znodes

Use this Zookeeper sub-command for transferring files and directories between Zookeeper znodes and your local drive. This command will copy from the local drive to Zookeeper, from Zookeeper to the local drive or from Zookeeper to Zookeeper.

[[SolrStartScriptReference-AvailableParameters.5]]
==== Available Parameters

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|cp |Copy files and directories to/from Zookeeper and the local drive |`cp`
|-r |Optional. Do a recursive copy. The command will fail if the <src> has children unless '-r' is specified |`-r`
|<src> |The file or path to copy from. If prefixed with 'zk:' then the source is presumed to be Zookeeper. If no prefix or the prefix is 'file:' this is the local drive. At least one of <src> or <dest> must be prefixed by 'zk:' or the command will fail. a|
zk:/configs/myconfigs/solrconfig.xml

file:/Users/apache/configs/src

|<dest> |The file or path to copy to. If prefixed with 'zk:' then the source is presumed to be Zookeeper. If no prefix or the prefix is 'file:' this is the local drive. At least one of <src> or <dest> must be prefixed by 'zk:' or the command will fail. If <dest> ends in a shash character it names a directory. a|
....
zk:/configs/myconfigs/solrconfig.xml
....

....
file:/Users/apache/configs/src
....

|-z <zkHost> |The ZooKeeper connection string. Unnecessary if ZK_HOST is defined in http://solr.in/[solr.in].sh or http://solr.in/[solr.in].cmd |`-z 123.321.23.43:2181 `
|===

An example of this command with the parameters is:

Recursively copy a directory from local to Zookeeper.

`bin/solr zk cp -r file:/apache/confgs/whatever/conf zk:/configs/myconf -z 111.222.333.444:2181`

Copy a single file from Zookeeper to local.

....
bin/solr zk cp zk:/configs/myconf/managed_schema /configs/myconf/managed_schema -z 111.222.333.444:2181
....

[[SolrStartScriptReference-RemoveaznodefromZookeeper]]
=== Remove a znode from Zookeeper

Use this ZooKeeper sub-command to remove a znode (and optionally all child nodes) from Zookeeper

[[SolrStartScriptReference-AvailableParameters.6]]
==== Available Parameters

// TODO: This table has cells that won't work with PDF: https://github.com/ctargett/refguide-asciidoc-poc/issues/13

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|rm |Remove znode(s) from Zookeeper |`rm`
|-r |Optional. Do a recursive removal. The command will fail if the <path> has children unless '-r' is specified |`-r`
|<path> a|
The path to remove from Zookeeper, either a parent or leaf node

There are limited safety checks, you cannot remove '/' or '/zookeeper' nodes.

The path is assumed to be a Zookeeper node no 'zk:' prefix is necessary

 a|
/configs

/configs/myconfigset

/config/myconfigset/solrconfig.xml

|-z <zkHost> |The ZooKeeper connection string. Unnecessary if ZK_HOST is defined in http://solr.in/[solr.in].sh or http://solr.in/[solr.in].cmd |`-z 123.321.23.43:2181 `
|===

An example of this command with the parameters is:

`bin/solr zk rm -r /configs`

....
bin/solr zk rm /configs/myconfigset/schema.xml
....

// OLD_CONFLUENCE_ID: SolrStartScriptReference-MoveoneZookeeperznodetoanother(rename)

[[SolrStartScriptReference-MoveoneZookeeperznodetoanother_rename_]]
=== Move one Zookeeper znode to another (rename)

Use this ZooKeeper sub-command to move (rename) a Zookeeper znode

[[SolrStartScriptReference-AvailableParameters.7]]
==== Available Parameters

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|mv |Move/rename a znode |`mv`
|<src> |Znode to rename. The 'zk:' prefix is assumed |`/configs/oldconfigset`
|<dest> |The new name of the znode. The 'zk:' prefix is assumed |/configs/newconfigset
|-z <zkHost> |The ZooKeeper connection string. Unnecessary if ZK_HOST is defined in http://solr.in/[solr.in].sh or http://solr.in/[solr.in].cmd |`-z 123.321.23.43:2181 `
|===

An example of this command is:

`bin/solr zk mv /configs/oldconfigset /configs/newconfigset`

// OLD_CONFLUENCE_ID: SolrStartScriptReference-ListaZookeeperznode'schildren

[[SolrStartScriptReference-ListaZookeeperznode_schildren]]
=== List a Zookeeper znode's children

Use this ZooKeeper sub-command to see the children of a znode.

[[SolrStartScriptReference-AvailableParameters.8]]
==== Available Parameters

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Parameter |Description |Example
|ls |Print out the children (optionally recursively) of a znode |`ls`
|-r |Optional. Recursively list all descendants of a znode |`-r`
|<path> |The path on Zookeeper to list. |/collections/mycollection
|-z <zkHost> |The ZooKeeper connection string. Unnecessary if ZK_HOST is defined in http://solr.in/[solr.in].sh or http://solr.in/[solr.in].cmd |`-z 123.321.23.43:2181 `
|===

An example of this command with the parameters is:

`bin/solr zk ls -r /collections/mycollection`

....
bin/solr zk ls /collections
....
